## YAML Template.
##---
$schema: http://json-schema.org/draft-04/schema#
id: "/response/ble"

type: object
definitions : 
    uuid :
        id : "uuid"
        type : string
        pattern: "^([-0-9a-fA-F]+)$"   ## "-"は許容
        minLength: 4
        maxLength: 36
    deviceAddress :
        id : "deviceAddress"
        type : string
        pattern: "^([0-9a-fA-F]+)$"
        minLength: 12
        maxLength: 12
        
additionalProperties: false
  
properties:
    scan_results :
        type : array
        minItems : 1
        items :
            type : object
            required: [event_type]
            additionalProperties: false
            properties:
                event_type : 
                    type : string
                    enum : [inquiry_result, inquiry_complete]
                address : {$ref :deviceAddress}
                ble_event_type : 
                    type : string
                    enum : 
                        - connectable_advertisemnt
                        - connectable_directed_advertisemnt
                        - scannable_advertising
                        - non_connectable_advertising
                        - scan_response
                device_type : 
                    type : string
                    enum : [ble, dumo, breder]
                address_type:
                    type : string
                    enum : [public, random, rpa_public, rpa_random]
                flag :
                    type : integer
                    maximun : 0
                rssi :
                    type : integer
                    maximun : 0
                adv_data : {$ref :#dataArray}
                scan_resp : {$ref :#dataArray}
    
    status_updates :
        type : array
        minItems : 1
        items :
            type : object 
            required: [address, status]
            additionalProperties: false
            properties:
                address : {$ref :deviceAddress}
                status : 
                    type: string
                    enum : [connected, disconnected]
            
    get_service_results :
        type : array
        minItems : 1
        items :
            type : object 
            required: [address,service_uuid]
            additionalProperties: false
            properties:
                address : {$ref :deviceAddress}
                service_uuid : {$ref :uuid}
                
                
    get_characteristic_results :
        type : array
        minItems : 1
        items :
            type : object 
            required: [address,service_uuid,characteristic_uuid]
            additionalProperties: false
            properties:
                address : {$ref :deviceAddress}
                service_uuid : {$ref :uuid}
                characteristic_uuid : {$ref :uuid}
                

    read_characteristic_results :
        type : array
        minItems : 1
        items :
            type : object 
            required: [address,service_uuid,characteristic_uuid, data]
            additionalProperties: false
            properties:
                address : {$ref :deviceAddress}
                service_uuid : {$ref :uuid}
                characteristic_uuid : {$ref :uuid}
                data : {$ref :#dataArray }
                

    write_characteristic_results :
        type : array
        minItems : 1
        items :
            type : object 
            required: [address,service_uuid,characteristic_uuid, result]
            additionalProperties: false
            properties:
                address : {$ref :deviceAddress}
                service_uuid : {$ref :uuid}
                characteristic_uuid : {$ref :uuid}
                result : 
                    type : string
                    enum : [success , failed]
                    
    peripheral:
        type : object 
        additionalProperties: false
        properties:
            connection_status : 
                type : array
                minItems : 1
                items :
                    type : object 
                    required: [address, status]
                    additionalProperties: false
                    properties:
                        address : {$ref :deviceAddress}
                        status : 
                            type : string
                            enum : [connected , disconnected]
            write_characteristic_results :
                type : array
                minItems : 1
                items :
                    type : object 
                    required: [service_uuid, characteristic_uuid, result]
                    additionalProperties: false
                    properties:
                        service_uuid : {$ref :uuid}
                        characteristic_uuid : {$ref :uuid}
                        result : 
                            type : string
                            enum : [success , failed]
                            
            read_characteristic_results :
                type : array
                minItems : 1
                items :
                    type : object 
                    required: [service_uuid, characteristic_uuid, data]
                    additionalProperties: false
                    properties:
                        service_uuid : {$ref :uuid}
                        characteristic_uuid : {$ref :uuid}
                        data : {$ref :#detaArray}
            notify_write_characteristics :
                type : array
                minItems : 1
                items :
                    type : object 
                    required: [address,service_uuid, characteristic_uuid, data]
                    additionalProperties: false
                    properties:
                        address : {$ref :deviceAddress}
                        service_uuid : {$ref :uuid}
                        characteristic_uuid : {$ref :uuid}
                        data : {$ref :#detaArray}
            notify_read_characteristics :
                type : array
                minItems : 1
                items :
                    type : object 
                    required: [address,service_uuid, characteristic_uuid]
                    additionalProperties: false
                    properties:
                        address : {$ref :deviceAddress}
                        service_uuid : {$ref :uuid}
                        characteristic_uuid : {$ref :uuid}

            write_descriptor_results :
                type : array
                minItems : 1
                items :
                    type : object 
                    required: [service_uuid, characteristic_uuid,descriptor_uuid,  result]
                    additionalProperties: false
                    properties:
                        service_uuid : {$ref :uuid}
                        characteristic_uuid : {$ref :uuid}
                        descriptor_uuid : {$ref :uuid}
                        result : 
                            type : string
                            enum : [success , failed]
                            
            read_descriptor_results :
                type : array
                minItems : 1
                items :
                    type : object 
                    required: [service_uuid, characteristic_uuid,descriptor_uuid,  data]
                    additionalProperties: false
                    properties:
                        service_uuid : {$ref :uuid}
                        characteristic_uuid : {$ref :uuid}
                        descriptor_uuid : {$ref :uuid}
                        data : {$ref :#detaArray}
            notify_write_descriptors :
                type : array
                minItems : 1
                items :
                    type : object 
                    required: [address,service_uuid, characteristic_uuid,descriptor_uuid,  data]
                    additionalProperties: false
                    properties:
                        address : {$ref :deviceAddress}
                        service_uuid : {$ref :uuid}
                        characteristic_uuid : {$ref :uuid}
                        descriptor_uuid : {$ref :uuid}
                        data : {$ref :#detaArray}
            notify_read_descriptors :
                type : array
                minItems : 1
                items :
                    type : object 
                    required: [address,service_uuid, characteristic_uuid,descriptor_uuid]
                    additionalProperties: false
                    properties:
                        address : {$ref :deviceAddress}
                        service_uuid : {$ref :uuid}
                        characteristic_uuid : {$ref :uuid}
                        descriptor_uuid : {$ref :uuid}

    errors : 
        type : array
        minItems : 1
        items :
            type : object 
            required: [error_code , message]
            additionalProperties: false
            properties:
                error_code :
                    type: integer
                message : 
                    typoe : string
                address : 
                    type : [{$ref :deviceAddress} , "null"]
                service_uuid : 
                    type : [{$ref :uuid} , "null"]
                characteristic_uuid : 
                    type : [{$ref :uuid} , "null"]
                descriptor_uuid : 
                    type : [{$ref :uuid} , "null"]
