"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
const i2cParts = require('../../i2cParts');
class MPU6886 extends i2cParts {
    static info() {
        return {
            name: 'MPU6886',
        };
    }
    constructor() {
        super();
        this.commands = {};
        this.commands.whoami = 0x75;
        this.commands.accelIntelCtrl = 0x69;
        this.commands.smplrtDiv = 0x19;
        this.commands.intPinCfg = 0x37;
        this.commands.intEnable = 0x38;
        this.commands.accelXoutH = 0x3b;
        this.commands.accelXoutL = 0x3c;
        this.commands.accelYoutH = 0x3d;
        this.commands.accelYoutL = 0x3e;
        this.commands.accelZoutH = 0x3f;
        this.commands.accelZoutL = 0x40;
        this.commands.tempOutH = 0x41;
        this.commands.tempOutL = 0x42;
        this.commands.gyroXoutH = 0x43;
        this.commands.gyroXoutL = 0x44;
        this.commands.gyroYoutH = 0x45;
        this.commands.gyroYoutL = 0x46;
        this.commands.gyroZoutH = 0x47;
        this.commands.gyroZoutL = 0x48;
        this.commands.userCtrl = 0x6a;
        this.commands.pwrMgmt1 = 0x6b;
        this.commands.pwrMgmt2 = 0x6c;
        this.commands.config = 0x1a;
        this.commands.gyroConfig = 0x1b;
        this.commands.accelConfig = 0x1c;
        this.commands.accelConfig2 = 0x1d;
        this.commands.fifoEn = 0x23;
    }
    wired(obniz) {
        super.wired(obniz);
        this.init();
    }
    i2cInfo() {
        return {
            address: 0x68,
            clock: 100000,
            voltage: '3v',
        };
    }
    whoamiWait() {
        return this.readWait(this.commands.whoami, 1)[0];
    }
    init() {
        this.write(this.commands.pwrMgmt1, 0x00);
        this.obniz.wait(10);
        this.write(this.commands.pwrMgmt1, 0x01 << 7);
        this.obniz.wait(10);
        this.write(this.commands.pwrMgmt1, 0x01 << 0);
        this.obniz.wait(10);
        this.setConfig(this.params.accelerometer_range || 2, this.params.gyroscope_range || 250);
        this.obniz.wait(1);
        this.write(this.commands.config, 0x01);
        this.obniz.wait(1);
        this.write(this.commands.smplrtDiv, 0x05);
        this.obniz.wait(1);
        this.write(this.commands.intEnable, 0x00);
        this.obniz.wait(1);
        this.write(this.commands.accelConfig2, 0x00);
        this.obniz.wait(1);
        this.write(this.commands.userCtrl, 0x00);
        this.obniz.wait(1);
        this.write(this.commands.fifoEn, 0x00);
        this.obniz.wait(1);
        this.write(this.commands.intPinCfg, 0x22);
        this.obniz.wait(1);
        this.write(this.commands.intEnable, 0x01);
        this.obniz.wait(1);
    }
    setConfig(accelerometer_range, gyroscope_range) {
        //accel range set (0x00:2g, 0x08:4g, 0x10:8g, 0x18:16g)
        switch (accelerometer_range) {
            case 2:
                this.write(this.commands.accelConfig, 0x00);
                break;
            case 4:
                this.write(this.commands.accelConfig, 0x08);
                break;
            case 8:
                this.write(this.commands.accelConfig, 0x10);
                break;
            case 16:
                this.write(this.commands.accelConfig, 0x18);
                break;
            default:
                throw new Error('accel_range variable 2,4,8,16 setting');
        }
        //gyro range & LPF set (0x00:250, 0x08:500, 0x10:1000, 0x18:2000[deg/s])
        switch (gyroscope_range) {
            case 250:
                this.write(this.commands.gyroConfig, 0x00);
                break;
            case 500:
                this.write(this.commands.gyroConfig, 0x08);
                break;
            case 1000:
                this.write(this.commands.gyroConfig, 0x10);
                break;
            case 2000:
                this.write(this.commands.gyroConfig, 0x18);
                break;
            default:
                throw new Error('accel_range variable 250,500,1000,2000 setting');
        }
        this._accel_range = accelerometer_range;
        this._gyro_range = gyroscope_range;
    }
    getAllDataWait() {
        return __awaiter(this, void 0, void 0, function* () {
            let raw_data = yield this.readWait(this.commands.accelXoutH, 14); //request all data
            let ac_scale = this._accel_range / 32768;
            let gy_scale = this._gyro_range / 32768;
            const accelerometer = {
                x: this.char2short(raw_data[0], raw_data[1]) * ac_scale,
                y: this.char2short(raw_data[2], raw_data[3]) * ac_scale,
                z: this.char2short(raw_data[4], raw_data[5]) * ac_scale,
            };
            const temperature = this.char2short(raw_data[6], raw_data[7]) / 326.8 + 25.0;
            const gyroscope = {
                x: this.char2short(raw_data[8], raw_data[9]) * gy_scale,
                y: this.char2short(raw_data[10], raw_data[11]) * gy_scale,
                z: this.char2short(raw_data[12], raw_data[13]) * gy_scale,
            };
            return {
                accelerometer,
                temperature,
                gyroscope,
            };
        });
    }
    getTempWait() {
        return __awaiter(this, void 0, void 0, function* () {
            return (yield this.getAllDataWait()).temperature;
        });
    }
    getAccelWait() {
        return __awaiter(this, void 0, void 0, function* () {
            return (yield this.getAllDataWait()).accelerometer;
        });
    }
    getGyroWait() {
        return __awaiter(this, void 0, void 0, function* () {
            return (yield this.getAllDataWait()).gyroscope;
        });
    }
}
if (typeof module === 'object') {
    module.exports = MPU6886;
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9wYXJ0cy9Nb3ZlbWVudFNlbnNvci9NUFU2ODg2L2luZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQSxNQUFNLFFBQVEsR0FBRyxPQUFPLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztBQUUzQyxNQUFNLE9BQVEsU0FBUSxRQUFRO0lBQzVCLE1BQU0sQ0FBQyxJQUFJO1FBQ1QsT0FBTztZQUNMLElBQUksRUFBRSxTQUFTO1NBQ2hCLENBQUM7SUFDSixDQUFDO0lBRUQ7UUFDRSxLQUFLLEVBQUUsQ0FBQztRQUNSLElBQUksQ0FBQyxRQUFRLEdBQUcsRUFBRSxDQUFDO1FBQ25CLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQztRQUM1QixJQUFJLENBQUMsUUFBUSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUM7UUFDcEMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDO1FBQy9CLElBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQztRQUMvQixJQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUM7UUFDL0IsSUFBSSxDQUFDLFFBQVEsQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO1FBQ2hDLElBQUksQ0FBQyxRQUFRLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQztRQUNoQyxJQUFJLENBQUMsUUFBUSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUM7UUFDaEMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO1FBQ2hDLElBQUksQ0FBQyxRQUFRLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQztRQUNoQyxJQUFJLENBQUMsUUFBUSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUM7UUFFaEMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDO1FBQzlCLElBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQztRQUU5QixJQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUM7UUFDL0IsSUFBSSxDQUFDLFFBQVEsQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDO1FBQy9CLElBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQztRQUMvQixJQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUM7UUFDL0IsSUFBSSxDQUFDLFFBQVEsQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDO1FBQy9CLElBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQztRQUUvQixJQUFJLENBQUMsUUFBUSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7UUFDOUIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDO1FBQzlCLElBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQztRQUM5QixJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUM7UUFDNUIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO1FBQ2hDLElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQztRQUNqQyxJQUFJLENBQUMsUUFBUSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUM7UUFDbEMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDO0lBQzlCLENBQUM7SUFFRCxLQUFLLENBQUMsS0FBSztRQUNULEtBQUssQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7UUFFbkIsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ2QsQ0FBQztJQUVELE9BQU87UUFDTCxPQUFPO1lBQ0wsT0FBTyxFQUFFLElBQUk7WUFDYixLQUFLLEVBQUUsTUFBTTtZQUNiLE9BQU8sRUFBRSxJQUFJO1NBQ2QsQ0FBQztJQUNKLENBQUM7SUFFRCxVQUFVO1FBQ1IsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ25ELENBQUM7SUFFRCxJQUFJO1FBQ0YsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUN6QyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNwQixJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxFQUFFLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQztRQUM5QyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNwQixJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxFQUFFLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQztRQUM5QyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNwQixJQUFJLENBQUMsU0FBUyxDQUNaLElBQUksQ0FBQyxNQUFNLENBQUMsbUJBQW1CLElBQUksQ0FBQyxFQUNwQyxJQUFJLENBQUMsTUFBTSxDQUFDLGVBQWUsSUFBSSxHQUFHLENBQ25DLENBQUM7UUFDRixJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNuQixJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ3ZDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ25CLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDMUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbkIsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUMxQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNuQixJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQzdDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ25CLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDekMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbkIsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsQ0FBQztRQUN2QyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNuQixJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQzFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ25CLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDMUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDckIsQ0FBQztJQUVELFNBQVMsQ0FBQyxtQkFBbUIsRUFBRSxlQUFlO1FBQzVDLHVEQUF1RDtRQUN2RCxRQUFRLG1CQUFtQixFQUFFO1lBQzNCLEtBQUssQ0FBQztnQkFDSixJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxDQUFDO2dCQUM1QyxNQUFNO1lBQ1IsS0FBSyxD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VSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsRUFBRSxRQUFRLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxRQUFRO2FBQzFELENBQUM7WUFFRixPQUFPO2dCQUNMLGFBQWE7Z0JBQ2IsV0FBVztnQkFDWCxTQUFTO2FBQ1YsQ0FBQztRQUNKLENBQUM7S0FBQTtJQUVLLFdBQVc7O1lBQ2YsT0FBTyxDQUFDLE1BQU0sSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDLENBQUMsV0FBVyxDQUFDO1FBQ25ELENBQUM7S0FBQTtJQUVLLFlBQVk7O1lBQ2hCLE9BQU8sQ0FBQyxNQUFNLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQyxDQUFDLGFBQWEsQ0FBQztRQUNyRCxDQUFDO0tBQUE7SUFFSyxXQUFXOztZQUNmLE9BQU8sQ0FBQyxNQUFNLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQyxDQUFDLFNBQVMsQ0FBQztRQUNqRCxDQUFDO0tBQUE7Q0FDRjtBQUVELElBQUksT0FBTyxNQUFNLEtBQUssUUFBUSxFQUFFO0lBQzlCLE1BQU0sQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO0NBQzFCIiwiZmlsZSI6InBhcnRzL01vdmVtZW50U2Vuc29yL01QVTY4ODYvaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBpMmNQYXJ0cyA9IHJlcXVpcmUoJy4uLy4uL2kyY1BhcnRzJyk7XG5cbmNsYXNzIE1QVTY4ODYgZXh0ZW5kcyBpMmNQYXJ0cyB7XG4gIHN0YXRpYyBpbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiAnTVBVNjg4NicsXG4gICAgfTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5jb21tYW5kcyA9IHt9O1xuICAgIHRoaXMuY29tbWFuZHMud2hvYW1pID0gMHg3NTtcbiAgICB0aGlzLmNvbW1hbmRzLmFjY2VsSW50ZWxDdHJsID0gMHg2OTtcbiAgICB0aGlzLmNvbW1hbmRzLnNtcGxydERpdiA9IDB4MTk7XG4gICAgdGhpcy5jb21tYW5kcy5pbnRQaW5DZmcgPSAweDM3O1xuICAgIHRoaXMuY29tbWFuZHMuaW50RW5hYmxlID0gMHgzODtcbiAgICB0aGlzLmNvbW1hbmRzLmFjY2VsWG91dEggPSAweDNiO1xuICAgIHRoaXMuY29tbWFuZHMuYWNjZWxYb3V0TCA9IDB4M2M7XG4gICAgdGhpcy5jb21tYW5kcy5hY2NlbFlvdXRIID0gMHgzZDtcbiAgICB0aGlzLmNvbW1hbmRzLmFjY2VsWW91dEwgPSAweDNlO1xuICAgIHRoaXMuY29tbWFuZHMuYWNjZWxab3V0SCA9IDB4M2Y7XG4gICAgdGhpcy5jb21tYW5kcy5hY2NlbFpvdXRMID0gMHg0MDtcblxuICAgIHRoaXMuY29tbWFuZHMudGVtcE91dEggPSAweDQxO1xuICAgIHRoaXMuY29tbWFuZHMudGVtcE91dEwgPSAweDQyO1xuXG4gICAgdGhpcy5jb21tYW5kcy5neXJvWG91dEggPSAweDQzO1xuICAgIHRoaXMuY29tbWFuZHMuZ3lyb1hvdXRMID0gMHg0NDtcbiAgICB0aGlzLmNvbW1hbmRzLmd5cm9Zb3V0SCA9IDB4NDU7XG4gICAgdGhpcy5jb21tYW5kcy5neXJvWW91dEwgPSAweDQ2O1xuICAgIHRoaXMuY29tbWFuZHMuZ3lyb1pvdXRIID0gMHg0NztcbiAgICB0aGlzLmNvbW1hbmRzLmd5cm9ab3V0TCA9IDB4NDg7XG5cbiAgICB0aGlzLmNvbW1hbmRzLnVzZXJDdHJsID0gMHg2YTtcbiAgICB0aGlzLmNvbW1hbmRzLnB3ck1nbXQxID0gMHg2YjtcbiAgICB0aGlzLmNvbW1hbmRzLnB3ck1nbXQyID0gMHg2YztcbiAgICB0aGlzLmNvbW1hbmRzLmNvbmZpZyA9IDB4MWE7XG4gICAgdGhpcy5jb21tYW5kcy5neXJvQ29uZmlnID0gMHgxYjtcbiAgICB0aGlzLmNvbW1hbmRzLmFjY2VsQ29uZmlnID0gMHgxYztcbiAgICB0aGlzLmNvbW1hbmRzLmFjY2VsQ29uZmlnMiA9IDB4MWQ7XG4gICAgdGhpcy5jb21tYW5kcy5maWZvRW4gPSAweDIzO1xuICB9XG5cbiAgd2lyZWQob2JuaXopIHtcbiAgICBzdXBlci53aXJlZChvYm5peik7XG5cbiAgICB0aGlzLmluaXQoKTtcbiAgfVxuXG4gIGkyY0luZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFkZHJlc3M6IDB4NjgsXG4gICAgICBjbG9jazogMTAwMDAwLFxuICAgICAgdm9sdGFnZTogJzN2JyxcbiAgICB9O1xuICB9XG5cbiAgd2hvYW1pV2FpdCgpIHtcbiAgICByZXR1cm4gdGhpcy5yZWFkV2FpdCh0aGlzLmNvbW1hbmRzLndob2FtaSwgMSlbMF07XG4gIH1cblxuICBpbml0KCkge1xuICAgIHRoaXMud3JpdGUodGhpcy5jb21tYW5kcy5wd3JNZ210MSwgMHgwMCk7XG4gICAgdGhpcy5vYm5pei53YWl0KDEwKTtcbiAgICB0aGlzLndyaXRlKHRoaXMuY29tbWFuZHMucHdyTWdtdDEsIDB4MDEgPDwgNyk7XG4gICAgdGhpcy5vYm5pei53YWl0KDEwKTtcbiAgICB0aGlzLndyaXRlKHRoaXMuY29tbWFuZHMucHdyTWdtdDEsIDB4MDEgPDwgMCk7XG4gICAgdGhpcy5vYm5pei53YWl0KDEwKTtcbiAgICB0aGlzLnNldENvbmZpZyhcbiAgICAgIHRoaXMucGFyYW1zLmFjY2VsZXJvbWV0ZXJfcmFuZ2UgfHwgMixcbiAgICAgIHRoaXMucGFyYW1zLmd5cm9zY29wZV9yYW5nZSB8fCAyNTBcbiAgICApO1xuICAgIHRoaXMub2JuaXoud2FpdCgxKTtcbiAgICB0aGlzLndyaXRlKHRoaXMuY29tbWFuZHMuY29uZmlnLCAweDAxKTtcbiAgICB0aGlzLm9ibml6LndhaXQoMSk7XG4gICAgdGhpcy53cml0ZSh0aGlzLmNvbW1hbmRzLnNtcGxydERpdiwgMHgwNSk7XG4gICAgdGhpcy5vYm5pei53YWl0KDEpO1xuICAgIHRoaXMud3JpdGUodGhpcy5jb21tYW5kcy5pbnRFbmFibGUsIDB4MDApO1xuICAgIHRoaXMub2JuaXoud2FpdCgxKTtcbiAgICB0aGlzLndyaXRlKHRoaXMuY29tbWFuZHMuYWNjZWxDb25maWcyLCAweDAwKTtcbiAgICB0aGlzLm9ibml6LndhaXQoMSk7XG4gICAgdGhpcy53cml0ZSh0aGlzLmNvbW1hbmRzLnVzZXJDdHJsLCAweDAwKTtcbiAgICB0aGlzLm9ibml6LndhaXQoMSk7XG4gICAgdGhpcy53cml0ZSh0aGlzLmNvbW1hbmRzLmZpZm9FbiwgMHgwMCk7XG4gICAgdGhpcy5vYm5pei53YWl0KDEpO1xuICAgIHRoaXMud3JpdGUodGhpcy5jb21tYW5kcy5pbnRQaW5DZmcsIDB4MjIpO1xuICAgIHRoaXMub2JuaXoud2FpdCgxKTtcbiAgICB0aGlzLndyaXRlKHRoaXMuY29tbWFuZHMuaW50RW5hYmxlLCAweDAxKTtcbiAgICB0aGlzLm9ibml6LndhaXQoMSk7XG4gIH1cblxuICBzZXRDb25maWcoYWNjZWxlcm9tZXRlcl9yYW5nZSwgZ3lyb3Njb3BlX3JhbmdlKSB7XG4gICAgLy9hY2NlbCByYW5nZSBzZXQgKDB4MDA6MmcsIDB4MDg6NGcsIDB4MTA6OGcsIDB4MTg6MTZnKVxuICAgIHN3aXRjaCAoYWNjZWxlcm9tZXRlcl9yYW5nZSkge1xuICAgICAgY2FzZSAyOlxuICAgICAgICB0aGlzLndyaXRlKHRoaXMuY29tbWFuZHMuYWNjZWxDb25maWcsIDB4MDApO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgNDpcbiAgICAgICAgdGhpcy53cml0ZSh0aGlzLmNvbW1hbmRzLmFjY2VsQ29uZmlnLCAweDA4KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDg6XG4gICAgICAgIHRoaXMud3JpdGUodGhpcy5jb21tYW5kcy5hY2NlbENvbmZpZywgMHgxMCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAxNjpcbiAgICAgICAgdGhpcy53cml0ZSh0aGlzLmNvbW1hbmRzLmFjY2VsQ29uZmlnLCAweDE4KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2FjY2VsX3JhbmdlIHZhcmlhYmxlIDIsNCw4LDE2IHNldHRpbmcnKTtcbiAgICB9XG4gICAgLy9neXJvIHJhbmdlICYgTFBGIHNldCAoMHgwMDoyNTAsIDB4MDg6NTAwLCAweDEwOjEwMDAsIDB4MTg6MjAwMFtkZWcvc10pXG4gICAgc3dpdGNoIChneXJvc2NvcGVfcmFuZ2UpIHtcbiAgICAgIGNhc2UgMjUwOlxuICAgICAgICB0aGlzLndyaXRlKHRoaXMuY29tbWFuZHMuZ3lyb0NvbmZpZywgMHgwMCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSA1MDA6XG4gICAgICAgIHRoaXMud3JpdGUodGhpcy5jb21tYW5kcy5neXJvQ29uZmlnLCAweDA4KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDEwMDA6XG4gICAgICAgIHRoaXMud3JpdGUodGhpcy5jb21tYW5kcy5neXJvQ29uZmlnLCAweDEwKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDIwMDA6XG4gICAgICAgIHRoaXMud3JpdGUodGhpcy5jb21tYW5kcy5neXJvQ29uZmlnLCAweDE4KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2FjY2VsX3JhbmdlIHZhcmlhYmxlIDI1MCw1MDAsMTAwMCwyMDAwIHNldHRpbmcnKTtcbiAgICB9XG4gICAgdGhpcy5fYWNjZWxfcmFuZ2UgPSBhY2NlbGVyb21ldGVyX3JhbmdlO1xuICAgIHRoaXMuX2d5cm9fcmFuZ2UgPSBneXJvc2NvcGVfcmFuZ2U7XG4gIH1cblxuICBhc3luYyBnZXRBbGxEYXRhV2FpdCgpIHtcbiAgICBsZXQgcmF3X2RhdGEgPSBhd2FpdCB0aGlzLnJlYWRXYWl0KHRoaXMuY29tbWFuZHMuYWNjZWxYb3V0SCwgMTQpOyAvL3JlcXVlc3QgYWxsIGRhdGFcbiAgICBsZXQgYWNfc2NhbGUgPSB0aGlzLl9hY2NlbF9yYW5nZSAvIDMyNzY4O1xuICAgIGxldCBneV9zY2FsZSA9IHRoaXMuX2d5cm9fcmFuZ2UgLyAzMjc2ODtcblxuICAgIGNvbnN0IGFjY2VsZXJvbWV0ZXIgPSB7XG4gICAgICB4OiB0aGlzLmNoYXIyc2hvcnQocmF3X2RhdGFbMF0sIHJhd19kYXRhWzFdKSAqIGFjX3NjYWxlLFxuICAgICAgeTogdGhpcy5jaGFyMnNob3J0KHJhd19kYXRhWzJdLCByYXdfZGF0YVszXSkgKiBhY19zY2FsZSxcbiAgICAgIHo6IHRoaXMuY2hhcjJzaG9ydChyYXdfZGF0YVs0XSwgcmF3X2RhdGFbNV0pICogYWNfc2NhbGUsXG4gICAgfTtcbiAgICBjb25zdCB0ZW1wZXJhdHVyZSA9XG4gICAgICB0aGlzLmNoYXIyc2hvcnQocmF3X2RhdGFbNl0sIHJhd19kYXRhWzddKSAvIDMyNi44ICsgMjUuMDtcbiAgICBjb25zdCBneXJvc2NvcGUgPSB7XG4gICAgICB4OiB0aGlzLmNoYXIyc2hvcnQocmF3X2RhdGFbOF0sIHJhd19kYXRhWzldKSAqIGd5X3NjYWxlLFxuICAgICAgeTogdGhpcy5jaGFyMnNob3J0KHJhd19kYXRhWzEwXSwgcmF3X2RhdGFbMTFdKSAqIGd5X3NjYWxlLFxuICAgICAgejogdGhpcy5jaGFyMnNob3J0KHJhd19kYXRhWzEyXSwgcmF3X2RhdGFbMTNdKSAqIGd5X3NjYWxlLFxuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgYWNjZWxlcm9tZXRlcixcbiAgICAgIHRlbXBlcmF0dXJlLFxuICAgICAgZ3lyb3Njb3BlLFxuICAgIH07XG4gIH1cblxuICBhc3luYyBnZXRUZW1wV2FpdCgpIHtcbiAgICByZXR1cm4gKGF3YWl0IHRoaXMuZ2V0QWxsRGF0YVdhaXQoKSkudGVtcGVyYXR1cmU7XG4gIH1cblxuICBhc3luYyBnZXRBY2NlbFdhaXQoKSB7XG4gICAgcmV0dXJuIChhd2FpdCB0aGlzLmdldEFsbERhdGFXYWl0KCkpLmFjY2VsZXJvbWV0ZXI7XG4gIH1cblxuICBhc3luYyBnZXRHeXJvV2FpdCgpIHtcbiAgICByZXR1cm4gKGF3YWl0IHRoaXMuZ2V0QWxsRGF0YVdhaXQoKSkuZ3lyb3Njb3BlO1xuICB9XG59XG5cbmlmICh0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jykge1xuICBtb2R1bGUuZXhwb3J0cyA9IE1QVTY4ODY7XG59XG4iXX0=
