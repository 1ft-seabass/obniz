"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
class WS2812 {
    constructor() {
        this.keys = ["din", "vcc", "gnd"];
        this.requiredKeys = ["din"];
    }
    static info() {
        return {
            name: "WS2812",
        };
    }
    static _generateFromByte(val) {
        // T0H 0.35us+-0.15us
        // T1H 0.7us+-0.15us
        // T0L 0.8us+-0.15us
        // T1L 0.6us+-0.15us
        // 0.3-0.9 and 0.6-0.6 at 3.33Mhz
        val = parseInt(val);
        const zero = 0x8;
        const one = 0xc;
        const ret = [];
        for (let i = 0; i < 8; i += 2) {
            let byte = 0;
            if (val & (0x80 >> i)) {
                byte = one << 4;
            }
            else {
                byte = zero << 4;
            }
            if (val & (0x80 >> (i + 1))) {
                byte |= one;
            }
            else {
                byte |= zero;
            }
            ret.push(byte);
        }
        return ret;
    }
    static _generateColor(r, g, b) {
        let array = WS2812._generateFromByte(g);
        array = array.concat(WS2812._generateFromByte(r));
        array = array.concat(WS2812._generateFromByte(b));
        return array;
    }
    static _generateHsvColor(h, s, v) {
        const C = v * s;
        const Hp = h / 60;
        const X = C * (1 - Math.abs((Hp % 2) - 1));
        let R;
        let G;
        let B;
        if (0 <= Hp && Hp < 1) {
            [R, G, B] = [C, X, 0];
        }
        if (1 <= Hp && Hp < 2) {
            [R, G, B] = [X, C, 0];
        }
        if (2 <= Hp && Hp < 3) {
            [R, G, B] = [0, C, X];
        }
        if (3 <= Hp && Hp < 4) {
            [R, G, B] = [0, X, C];
        }
        if (4 <= Hp && Hp < 5) {
            [R, G, B] = [X, 0, C];
        }
        if (5 <= Hp && Hp < 6) {
            [R, G, B] = [C, 0, X];
        }
        const m = v - C;
        [R, G, B] = [R + m, G + m, B + m];
        R = Math.floor(R * 255);
        G = Math.floor(G * 255);
        B = Math.floor(B * 255);
        return WS2812._generateColor(R, G, B);
    }
    wired(obniz) {
        this.obniz = obniz;
        obniz.setVccGnd(this.params.vcc, this.params.gnd, "5v");
        this.params.mode = "master";
        this.params.frequency = Math.floor(3.33 * 1000 * 1000);
        this.params.mosi = this.params.din;
        this.params.drive = "5v"; // It over spec for frequency. But VIN-HI require 0.7VCC<=.
        this.spi = this.obniz.getSpiWithConfig(this.params);
    }
    rgb(r, g, b) {
        this.spi.write(WS2812._generateColor(r, g, b));
    }
    hsv(h, s, v) {
        this.spi.write(WS2812._generateHsvColor(h, s, v));
    }
    rgbs(array) {
        let bytes = [];
        for (let i = 0; i < array.length; i++) {
            const oneArray = array[i];
            bytes = bytes.concat(WS2812._generateColor(oneArray[0], oneArray[1], oneArray[2]));
        }
        this.spi.write(bytes);
    }
    hsvs(array) {
        let bytes = [];
        for (let i = 0; i < array.length; i++) {
            const oneArray = array[i];
            bytes = bytes.concat(WS2812._generateHsvColor(oneArray[0], oneArray[1], oneArray[2]));
        }
        this.spi.write(bytes);
    }
}
exports.default = WS2812;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9wYXJ0cy9MaWdodC9XUzI4MTIvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNLE1BQU07SUFxRlY7UUFDRSxJQUFJLENBQUMsSUFBSSxHQUFHLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQztRQUNsQyxJQUFJLENBQUMsWUFBWSxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDOUIsQ0FBQztJQXRGTSxNQUFNLENBQUMsSUFBSTtRQUNoQixPQUFPO1lBQ0wsSUFBSSxFQUFFLFFBQVE7U0FDZixDQUFDO0lBQ0osQ0FBQztJQUVNLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxHQUFRO1FBQ3RDLHFCQUFxQjtRQUNyQixvQkFBb0I7UUFDcEIsb0JBQW9CO1FBQ3BCLG9CQUFvQjtRQUVwQixpQ0FBaUM7UUFFakMsR0FBRyxHQUFHLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNwQixNQUFNLElBQUksR0FBUSxHQUFHLENBQUM7UUFDdEIsTUFBTSxHQUFHLEdBQVEsR0FBRyxDQUFDO1FBQ3JCLE1BQU0sR0FBRyxHQUFRLEVBQUUsQ0FBQztRQUNwQixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDN0IsSUFBSSxJQUFJLEdBQVEsQ0FBQyxDQUFDO1lBQ2xCLElBQUksR0FBRyxHQUFHLENBQUMsSUFBSSxJQUFJLENBQUMsQ0FBQyxFQUFFO2dCQUNyQixJQUFJLEdBQUcsR0FBRyxJQUFJLENBQUMsQ0FBQzthQUNqQjtpQkFBTTtnQkFDTCxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsQ0FBQzthQUNsQjtZQUNELElBQUksR0FBRyxHQUFHLENBQUMsSUFBSSxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUU7Z0JBQzNCLElBQUksSUFBSSxHQUFHLENBQUM7YUFDYjtpQkFBTTtnQkFDTCxJQUFJLElBQUksSUFBSSxDQUFDO2FBQ2Q7WUFDRCxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ2hCO1FBQ0QsT0FBTyxHQUFHLENBQUM7SUFDYixDQUFDO0lBRU0sTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFNLEVBQUUsQ0FBTSxFQUFFLENBQU07UUFDakQsSUFBSSxLQUFLLEdBQVEsTUFBTSxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzdDLEtBQUssR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2xELEtBQUssR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2xELE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQztJQUVNLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFNLEVBQUUsQ0FBTSxFQUFFLENBQU07UUFDcEQsTUFBTSxDQUFDLEdBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNyQixNQUFNLEVBQUUsR0FBUSxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBQ3ZCLE1BQU0sQ0FBQyxHQUFRLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFaEQsSUFBSSxDQUFNLENBQUM7UUFBQyxJQUFJLENBQU0sQ0FBQztRQUFDLElBQUksQ0FBTSxDQUFDO1FBQ25DLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLEdBQUcsQ0FBQyxFQUFFO1lBQ3JCLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7U0FDdkI7UUFDRCxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxHQUFHLENBQUMsRUFBRTtZQUNyQixDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1NBQ3ZCO1FBQ0QsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsR0FBRyxDQUFDLEVBQUU7WUFDckIsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztTQUN2QjtRQUNELElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLEdBQUcsQ0FBQyxFQUFFO1lBQ3JCLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7U0FDdkI7UUFDRCxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxHQUFHLENBQUMsRUFBRTtZQUNyQixDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1NBQ3ZCO1FBQ0QsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsR0FBRyxDQUFDLEVBQUU7WUFDckIsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztTQUN2QjtRQUVELE1BQU0sQ0FBQyxHQUFRLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDckIsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUVsQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUM7UUFDeEIsQ0FBQyxHQUFHLElBQUksQ0FBQyxL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L0xpZ2h0L1dTMjgxMi9pbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFdTMjgxMiB7XG5cbiAgcHVibGljIHN0YXRpYyBpbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiBcIldTMjgxMlwiLFxuICAgIH07XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIF9nZW5lcmF0ZUZyb21CeXRlKHZhbDogYW55KSB7XG4gICAgLy8gVDBIIDAuMzV1cystMC4xNXVzXG4gICAgLy8gVDFIIDAuN3VzKy0wLjE1dXNcbiAgICAvLyBUMEwgMC44dXMrLTAuMTV1c1xuICAgIC8vIFQxTCAwLjZ1cystMC4xNXVzXG5cbiAgICAvLyAwLjMtMC45IGFuZCAwLjYtMC42IGF0IDMuMzNNaHpcblxuICAgIHZhbCA9IHBhcnNlSW50KHZhbCk7XG4gICAgY29uc3QgemVybzogYW55ID0gMHg4O1xuICAgIGNvbnN0IG9uZTogYW55ID0gMHhjO1xuICAgIGNvbnN0IHJldDogYW55ID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCA4OyBpICs9IDIpIHtcbiAgICAgIGxldCBieXRlOiBhbnkgPSAwO1xuICAgICAgaWYgKHZhbCAmICgweDgwID4+IGkpKSB7XG4gICAgICAgIGJ5dGUgPSBvbmUgPDwgNDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJ5dGUgPSB6ZXJvIDw8IDQ7XG4gICAgICB9XG4gICAgICBpZiAodmFsICYgKDB4ODAgPj4gKGkgKyAxKSkpIHtcbiAgICAgICAgYnl0ZSB8PSBvbmU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBieXRlIHw9IHplcm87XG4gICAgICB9XG4gICAgICByZXQucHVzaChieXRlKTtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgX2dlbmVyYXRlQ29sb3IocjogYW55LCBnOiBhbnksIGI6IGFueSkge1xuICAgIGxldCBhcnJheTogYW55ID0gV1MyODEyLl9nZW5lcmF0ZUZyb21CeXRlKGcpO1xuICAgIGFycmF5ID0gYXJyYXkuY29uY2F0KFdTMjgxMi5fZ2VuZXJhdGVGcm9tQnl0ZShyKSk7XG4gICAgYXJyYXkgPSBhcnJheS5jb25jYXQoV1MyODEyLl9nZW5lcmF0ZUZyb21CeXRlKGIpKTtcbiAgICByZXR1cm4gYXJyYXk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIF9nZW5lcmF0ZUhzdkNvbG9yKGg6IGFueSwgczogYW55LCB2OiBhbnkpIHtcbiAgICBjb25zdCBDOiBhbnkgPSB2ICogcztcbiAgICBjb25zdCBIcDogYW55ID0gaCAvIDYwO1xuICAgIGNvbnN0IFg6IGFueSA9IEMgKiAoMSAtIE1hdGguYWJzKChIcCAlIDIpIC0gMSkpO1xuXG4gICAgbGV0IFI6IGFueTsgbGV0IEc6IGFueTsgbGV0IEI6IGFueTtcbiAgICBpZiAoMCA8PSBIcCAmJiBIcCA8IDEpIHtcbiAgICAgIFtSLCBHLCBCXSA9IFtDLCBYLCAwXTtcbiAgICB9XG4gICAgaWYgKDEgPD0gSHAgJiYgSHAgPCAyKSB7XG4gICAgICBbUiwgRywgQl0gPSBbWCwgQywgMF07XG4gICAgfVxuICAgIGlmICgyIDw9IEhwICYmIEhwIDwgMykge1xuICAgICAgW1IsIEcsIEJdID0gWzAsIEMsIFhdO1xuICAgIH1cbiAgICBpZiAoMyA8PSBIcCAmJiBIcCA8IDQpIHtcbiAgICAgIFtSLCBHLCBCXSA9IFswLCBYLCBDXTtcbiAgICB9XG4gICAgaWYgKDQgPD0gSHAgJiYgSHAgPCA1KSB7XG4gICAgICBbUiwgRywgQl0gPSBbWCwgMCwgQ107XG4gICAgfVxuICAgIGlmICg1IDw9IEhwICYmIEhwIDwgNikge1xuICAgICAgW1IsIEcsIEJdID0gW0MsIDAsIFhdO1xuICAgIH1cblxuICAgIGNvbnN0IG06IGFueSA9IHYgLSBDO1xuICAgIFtSLCBHLCBCXSA9IFtSICsgbSwgRyArIG0sIEIgKyBtXTtcblxuICAgIFIgPSBNYXRoLmZsb29yKFIgKiAyNTUpO1xuICAgIEcgPSBNYXRoLmZsb29yKEcgKiAyNTUpO1xuICAgIEIgPSBNYXRoLmZsb29yKEIgKiAyNTUpO1xuXG4gICAgcmV0dXJuIFdTMjgxMi5fZ2VuZXJhdGVDb2xvcihSLCBHLCBCKTtcbiAgfVxuXG4gIHB1YmxpYyBrZXlzOiBhbnk7XG4gIHB1YmxpYyByZXF1aXJlZEtleXM6IGFueTtcbiAgcHVibGljIG9ibml6OiBhbnk7XG4gIHB1YmxpYyBwYXJhbXM6IGFueTtcbiAgcHVibGljIHNwaTogYW55O1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMua2V5cyA9IFtcImRpblwiLCBcInZjY1wiLCBcImduZFwiXTtcbiAgICB0aGlzLnJlcXVpcmVkS2V5cyA9IFtcImRpblwiXTtcbiAgfVxuXG4gIHB1YmxpYyB3aXJlZChvYm5pejogYW55KSB7XG4gICAgdGhpcy5vYm5peiA9IG9ibml6O1xuXG4gICAgb2JuaXouc2V0VmNjR25kKHRoaXMucGFyYW1zLnZjYywgdGhpcy5wYXJhbXMuZ25kLCBcIjV2XCIpO1xuXG4gICAgdGhpcy5wYXJhbXMubW9kZSA9IFwibWFzdGVyXCI7XG4gICAgdGhpcy5wYXJhbXMuZnJlcXVlbmN5ID0gTWF0aC5mbG9vcigzLjMzICogMTAwMCAqIDEwMDApO1xuICAgIHRoaXMucGFyYW1zLm1vc2kgPSB0aGlzLnBhcmFtcy5kaW47XG4gICAgdGhpcy5wYXJhbXMuZHJpdmUgPSBcIjV2XCI7IC8vIEl0IG92ZXIgc3BlYyBmb3IgZnJlcXVlbmN5LiBCdXQgVklOLUhJIHJlcXVpcmUgMC43VkNDPD0uXG4gICAgdGhpcy5zcGkgPSB0aGlzLm9ibml6LmdldFNwaVdpdGhDb25maWcodGhpcy5wYXJhbXMpO1xuICB9XG5cbiAgcHVibGljIHJnYihyOiBhbnksIGc6IGFueSwgYjogYW55KSB7XG4gICAgdGhpcy5zcGkud3JpdGUoV1MyODEyLl9nZW5lcmF0ZUNvbG9yKHIsIGcsIGIpKTtcbiAgfVxuXG4gIHB1YmxpYyBoc3YoaDogYW55LCBzOiBhbnksIHY6IGFueSkge1xuICAgIHRoaXMuc3BpLndyaXRlKFdTMjgxMi5fZ2VuZXJhdGVIc3ZDb2xvcihoLCBzLCB2KSk7XG4gIH1cblxuICBwdWJsaWMgcmdicyhhcnJheTogYW55KSB7XG4gICAgbGV0IGJ5dGVzOiBhbnkgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBvbmVBcnJheTogYW55ID0gYXJyYXlbaV07XG4gICAgICBieXRlcyA9IGJ5dGVzLmNvbmNhdChcbiAgICAgICAgV1MyODEyLl9nZW5lcmF0ZUNvbG9yKG9uZUFycmF5WzBdLCBvbmVBcnJheVsxXSwgb25lQXJyYXlbMl0pLFxuICAgICAgKTtcbiAgICB9XG4gICAgdGhpcy5zcGkud3JpdGUoYnl0ZXMpO1xuICB9XG5cbiAgcHVibGljIGhzdnMoYXJyYXk6IGFueSkge1xuICAgIGxldCBieXRlczogYW55ID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3Qgb25lQXJyYXk6IGFueSA9IGFycmF5W2ldO1xuICAgICAgYnl0ZXMgPSBieXRlcy5jb25jYXQoXG4gICAgICAgIFdTMjgxMi5fZ2VuZXJhdGVIc3ZDb2xvcihvbmVBcnJheVswXSwgb25lQXJyYXlbMV0sIG9uZUFycmF5WzJdKSxcbiAgICAgICk7XG4gICAgfVxuICAgIHRoaXMuc3BpLndyaXRlKGJ5dGVzKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBXUzI4MTI7XG4iXX0=
