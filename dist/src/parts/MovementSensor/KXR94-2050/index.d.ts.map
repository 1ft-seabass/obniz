{"version":3,"sources":["../src/parts/MovementSensor/KXR94-2050/index.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,MAAM,gBAAgB,CAAC;AACnC,OAAO,mBAAmB,EAAE,EAAC,cAAc,EAAC,MAAM,oCAAoC,CAAC;AAEvF,MAAM,WAAW,iBAAiB;CACjC;AAED,cAAM,UAAW,YAAW,mBAAmB;WAE/B,IAAI,IAAI,cAAc;IAM7B,IAAI,EAAE,MAAM,EAAE,CAAC;IACf,YAAY,EAAE,MAAM,EAAE,CAAC;IACvB,KAAK,EAAG,KAAK,CAAC;IACd,MAAM,EAAE,GAAG,CAAC;IACZ,IAAI,EAAE,GAAG,CAAC;IACV,IAAI,EAAE,GAAG,CAAC;IACV,IAAI,EAAE,GAAG,CAAC;IACV,MAAM,EAAE,GAAG,CAAC;IACZ,SAAS,EAAE,GAAG,CAAC;IACf,QAAQ,EAAE,GAAG,CAAC;IACd,MAAM,EAAE,GAAG,CAAC;IACZ,SAAS,EAAE,GAAG,CAAC;IACf,MAAM,EAAE,GAAG,CAAC;IACZ,SAAS,EAAE,GAAG,CAAC;IACf,WAAW,EAAE,GAAG,CAAC;IACjB,aAAa,EAAE,GAAG,CAAC;;IAOnB,KAAK,CAAC,KAAK,EAAE,KAAK;IA0DlB,gBAAgB,CAAC,UAAU,EAAE,GAAG;IAKhC,eAAe,CAAC,IAAI,EAAE,GAAG;IAIzB,GAAG;;;;;IAIH,IAAI;;;;;IAQE,OAAO;;;;;CAOrB;AAED,eAAe,UAAU,CAAC","file":"index.d.ts","sourcesContent":["import Obniz from \"../../../obniz\";\nimport ObnizPartsInterface, {ObnizPartsInfo} from \"../../../obniz/ObnizPartsInterface\";\n\nexport interface KXR94_2050Options {\n}\n\nclass KXR94_2050 implements ObnizPartsInterface {\n\n  public static info(): ObnizPartsInfo {\n    return {\n      name: \"KXR94-2050\",\n    };\n  }\n\n  public keys: string[];\n  public requiredKeys: string[];\n  public obniz!: Obniz;\n  public params: any;\n  public ad_x: any;\n  public ad_y: any;\n  public ad_z: any;\n  public _x_val: any;\n  public onChangeX: any;\n  public onChange: any;\n  public _y_val: any;\n  public onChangeY: any;\n  public _z_val: any;\n  public onChangeZ: any;\n  public sensitivity: any;\n  public offsetVoltage: any;\n\n  constructor() {\n    this.keys = [\"x\", \"y\", \"z\", \"vcc\", \"gnd\", \"enable\", \"self_test\"];\n    this.requiredKeys = [\"x\", \"y\", \"z\"];\n  }\n\n  public wired(obniz: Obniz) {\n    this.obniz = obniz;\n\n    obniz.setVccGnd(this.params.vcc, this.params.gnd, \"5v\");\n\n    this.ad_x = obniz.getAD(this.params.x);\n    this.ad_y = obniz.getAD(this.params.y);\n    this.ad_z = obniz.getAD(this.params.z);\n\n    if (obniz.isValidIO(this.params.enable)) {\n      obniz.getIO(this.params.enable).drive(\"5v\");\n      obniz.getIO(this.params.enable).output(true);\n\n    }\n    if (obniz.isValidIO(this.params.self_test)) {\n      obniz.getIO(this.params.self_test).drive(\"5v\");\n      obniz.getIO(this.params.self_test).output(false);\n    }\n\n    this.changeVccVoltage(5);\n\n    this.ad_x.start((value: any) => {\n      this._x_val = value;\n      if (this.onChangeX) {\n        this.onChangeX(this.voltage2gravity(value));\n      }\n      if (this.onChange) {\n        this.onChange(this._get());\n      }\n    });\n\n    this.ad_y.start((value: any) => {\n      this._y_val = value;\n      if (this.onChangeY) {\n        this.onChangeY(this.voltage2gravity(value));\n      }\n      if (this.onChange) {\n        this.onChange(this._get());\n      }\n    });\n\n    this.ad_z.start((value: any) => {\n      this._z_val = value;\n      if (this.onChangeZ) {\n        this.onChangeZ(this.voltage2gravity(value));\n      }\n      if (this.onChange) {\n        this.onChange(this._get());\n      }\n    });\n\n    if (this.obniz.isValidIO(this.params.vcc)) {\n      this.obniz.getAD(this.params.vcc).start((value: any) => {\n        this.changeVccVoltage(value);\n      });\n    }\n  }\n\n  public changeVccVoltage(pwrVoltage: any) {\n    this.sensitivity = pwrVoltage / 5; // Set sensitivity (unit:V)\n    this.offsetVoltage = pwrVoltage / 2; // Set offset voltage (Output voltage at 0g, unit:V)\n  }\n\n  public voltage2gravity(volt: any) {\n    return (volt - this.offsetVoltage) / this.sensitivity;\n  }\n\n  public get() {\n    return this._get();\n  }\n\n  public _get() {\n    return {\n      x: this.voltage2gravity(this._x_val),\n      y: this.voltage2gravity(this._y_val),\n      z: this.voltage2gravity(this._z_val),\n    };\n  }\n\n  public async getWait() {\n    this._x_val = await this.ad_x.getWait();\n    this._y_val = await this.ad_y.getWait();\n    this._z_val = await this.ad_z.getWait();\n\n    return this._get();\n  }\n}\n\nexport default KXR94_2050;\n"]}