"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
const i2cParts = require("../../i2cParts");
class MPU6886 extends i2cParts {
    constructor() {
        super();
        this.commands = {};
        this.commands.whoami = 0x75;
        this.commands.accelIntelCtrl = 0x69;
        this.commands.smplrtDiv = 0x19;
        this.commands.intPinCfg = 0x37;
        this.commands.intEnable = 0x38;
        this.commands.accelXoutH = 0x3b;
        this.commands.accelXoutL = 0x3c;
        this.commands.accelYoutH = 0x3d;
        this.commands.accelYoutL = 0x3e;
        this.commands.accelZoutH = 0x3f;
        this.commands.accelZoutL = 0x40;
        this.commands.tempOutH = 0x41;
        this.commands.tempOutL = 0x42;
        this.commands.gyroXoutH = 0x43;
        this.commands.gyroXoutL = 0x44;
        this.commands.gyroYoutH = 0x45;
        this.commands.gyroYoutL = 0x46;
        this.commands.gyroZoutH = 0x47;
        this.commands.gyroZoutL = 0x48;
        this.commands.userCtrl = 0x6a;
        this.commands.pwrMgmt1 = 0x6b;
        this.commands.pwrMgmt2 = 0x6c;
        this.commands.config = 0x1a;
        this.commands.gyroConfig = 0x1b;
        this.commands.accelConfig = 0x1c;
        this.commands.accelConfig2 = 0x1d;
        this.commands.fifoEn = 0x23;
    }
    static info() {
        return {
            name: "MPU6886",
        };
    }
    wired(obniz) {
        super.wired(obniz);
        this.init();
    }
    i2cInfo() {
        return {
            address: 0x68,
            clock: 100000,
            voltage: "3v",
        };
    }
    whoamiWait() {
        return this.readWait(this.commands.whoami, 1)[0];
    }
    init() {
        this.write(this.commands.pwrMgmt1, 0x00);
        this.obniz.wait(10);
        this.write(this.commands.pwrMgmt1, 0x01 << 7);
        this.obniz.wait(10);
        this.write(this.commands.pwrMgmt1, 0x01 << 0);
        this.obniz.wait(10);
        this.setConfig(this.params.accelerometer_range || 2, this.params.gyroscope_range || 250);
        this.obniz.wait(1);
        this.write(this.commands.config, 0x01);
        this.obniz.wait(1);
        this.write(this.commands.smplrtDiv, 0x05);
        this.obniz.wait(1);
        this.write(this.commands.intEnable, 0x00);
        this.obniz.wait(1);
        this.write(this.commands.accelConfig2, 0x00);
        this.obniz.wait(1);
        this.write(this.commands.userCtrl, 0x00);
        this.obniz.wait(1);
        this.write(this.commands.fifoEn, 0x00);
        this.obniz.wait(1);
        this.write(this.commands.intPinCfg, 0x22);
        this.obniz.wait(1);
        this.write(this.commands.intEnable, 0x01);
        this.obniz.wait(1);
    }
    setConfig(accelerometer_range, gyroscope_range) {
        // accel range set (0x00:2g, 0x08:4g, 0x10:8g, 0x18:16g)
        switch (accelerometer_range) {
            case 2:
                this.write(this.commands.accelConfig, 0x00);
                break;
            case 4:
                this.write(this.commands.accelConfig, 0x08);
                break;
            case 8:
                this.write(this.commands.accelConfig, 0x10);
                break;
            case 16:
                this.write(this.commands.accelConfig, 0x18);
                break;
            default:
                throw new Error("accel_range variable 2,4,8,16 setting");
        }
        // gyro range & LPF set (0x00:250, 0x08:500, 0x10:1000, 0x18:2000[deg/s])
        switch (gyroscope_range) {
            case 250:
                this.write(this.commands.gyroConfig, 0x00);
                break;
            case 500:
                this.write(this.commands.gyroConfig, 0x08);
                break;
            case 1000:
                this.write(this.commands.gyroConfig, 0x10);
                break;
            case 2000:
                this.write(this.commands.gyroConfig, 0x18);
                break;
            default:
                throw new Error("accel_range variable 250,500,1000,2000 setting");
        }
        this._accel_range = accelerometer_range;
        this._gyro_range = gyroscope_range;
    }
    getAllDataWait() {
        return __awaiter(this, void 0, void 0, function* () {
            const raw_data = yield this.readWait(this.commands.accelXoutH, 14); // request all data
            const ac_scale = this._accel_range / 32768;
            const gy_scale = this._gyro_range / 32768;
            const accelerometer = {
                x: this.char2short(raw_data[0], raw_data[1]) * ac_scale,
                y: this.char2short(raw_data[2], raw_data[3]) * ac_scale,
                z: this.char2short(raw_data[4], raw_data[5]) * ac_scale,
            };
            const temperature = this.char2short(raw_data[6], raw_data[7]) / 326.8 + 25.0;
            const gyroscope = {
                x: this.char2short(raw_data[8], raw_data[9]) * gy_scale,
                y: this.char2short(raw_data[10], raw_data[11]) * gy_scale,
                z: this.char2short(raw_data[12], raw_data[13]) * gy_scale,
            };
            return {
                accelerometer,
                temperature,
                gyroscope,
            };
        });
    }
    getTempWait() {
        return __awaiter(this, void 0, void 0, function* () {
            return (yield this.getAllDataWait()).temperature;
        });
    }
    getAccelWait() {
        return __awaiter(this, void 0, void 0, function* () {
            return (yield this.getAllDataWait()).accelerometer;
        });
    }
    getGyroWait() {
        return __awaiter(this, void 0, void 0, function* () {
            return (yield this.getAllDataWait()).gyroscope;
        });
    }
}
exports.default = MPU6886;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9wYXJ0cy9Nb3ZlbWVudFNlbnNvci9NUFU2ODg2L2luZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUEsTUFBTSxRQUFRLEdBQVEsT0FBTyxDQUFDLGdCQUFnQixDQUFDLENBQUM7QUFFaEQsTUFBTSxPQUFRLFNBQVEsUUFBUTtJQWlCNUI7UUFDRSxLQUFLLEVBQUUsQ0FBQztRQUNSLElBQUksQ0FBQyxRQUFRLEdBQUcsRUFBRSxDQUFDO1FBQ25CLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQztRQUM1QixJQUFJLENBQUMsUUFBUSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUM7UUFDcEMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDO1FBQy9CLElBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQztRQUMvQixJQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUM7UUFDL0IsSUFBSSxDQUFDLFFBQVEsQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO1FBQ2hDLElBQUksQ0FBQyxRQUFRLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQztRQUNoQyxJQUFJLENBQUMsUUFBUSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUM7UUFDaEMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO1FBQ2hDLElBQUksQ0FBQyxRQUFRLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQztRQUNoQyxJQUFJLENBQUMsUUFBUSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUM7UUFFaEMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDO1FBQzlCLElBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQztRQUU5QixJQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUM7UUFDL0IsSUFBSSxDQUFD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QUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLEVBQUUsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsUUFBUTthQUMxRCxDQUFDO1lBRUYsT0FBTztnQkFDTCxhQUFhO2dCQUNiLFdBQVc7Z0JBQ1gsU0FBUzthQUNWLENBQUM7UUFDSixDQUFDO0tBQUE7SUFFWSxXQUFXOztZQUN0QixPQUFPLENBQUMsTUFBTSxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUMsQ0FBQyxXQUFXLENBQUM7UUFDbkQsQ0FBQztLQUFBO0lBRVksWUFBWTs7WUFDdkIsT0FBTyxDQUFDLE1BQU0sSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDLENBQUMsYUFBYSxDQUFDO1FBQ3JELENBQUM7S0FBQTtJQUVZLFdBQVc7O1lBQ3RCLE9BQU8sQ0FBQyxNQUFNLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQyxDQUFDLFNBQVMsQ0FBQztRQUNqRCxDQUFDO0tBQUE7Q0FDRjtBQUVELGtCQUFlLE9BQU8sQ0FBQyIsImZpbGUiOiJzcmMvcGFydHMvTW92ZW1lbnRTZW5zb3IvTVBVNjg4Ni9pbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGkyY1BhcnRzOiBhbnkgPSByZXF1aXJlKFwiLi4vLi4vaTJjUGFydHNcIik7XG5cbmNsYXNzIE1QVTY4ODYgZXh0ZW5kcyBpMmNQYXJ0cyB7XG5cbiAgcHVibGljIHN0YXRpYyBpbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiBcIk1QVTY4ODZcIixcbiAgICB9O1xuICB9XG5cbiAgcHVibGljIGNvbW1hbmRzOiBhbnk7XG4gIHB1YmxpYyByZWFkV2FpdDogYW55O1xuICBwdWJsaWMgd3JpdGU6IGFueTtcbiAgcHVibGljIG9ibml6OiBhbnk7XG4gIHB1YmxpYyBwYXJhbXM6IGFueTtcbiAgcHVibGljIF9hY2NlbF9yYW5nZTogYW55O1xuICBwdWJsaWMgX2d5cm9fcmFuZ2U6IGFueTtcbiAgcHVibGljIGNoYXIyc2hvcnQ6IGFueTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuY29tbWFuZHMgPSB7fTtcbiAgICB0aGlzLmNvbW1hbmRzLndob2FtaSA9IDB4NzU7XG4gICAgdGhpcy5jb21tYW5kcy5hY2NlbEludGVsQ3RybCA9IDB4Njk7XG4gICAgdGhpcy5jb21tYW5kcy5zbXBscnREaXYgPSAweDE5O1xuICAgIHRoaXMuY29tbWFuZHMuaW50UGluQ2ZnID0gMHgzNztcbiAgICB0aGlzLmNvbW1hbmRzLmludEVuYWJsZSA9IDB4Mzg7XG4gICAgdGhpcy5jb21tYW5kcy5hY2NlbFhvdXRIID0gMHgzYjtcbiAgICB0aGlzLmNvbW1hbmRzLmFjY2VsWG91dEwgPSAweDNjO1xuICAgIHRoaXMuY29tbWFuZHMuYWNjZWxZb3V0SCA9IDB4M2Q7XG4gICAgdGhpcy5jb21tYW5kcy5hY2NlbFlvdXRMID0gMHgzZTtcbiAgICB0aGlzLmNvbW1hbmRzLmFjY2VsWm91dEggPSAweDNmO1xuICAgIHRoaXMuY29tbWFuZHMuYWNjZWxab3V0TCA9IDB4NDA7XG5cbiAgICB0aGlzLmNvbW1hbmRzLnRlbXBPdXRIID0gMHg0MTtcbiAgICB0aGlzLmNvbW1hbmRzLnRlbXBPdXRMID0gMHg0MjtcblxuICAgIHRoaXMuY29tbWFuZHMuZ3lyb1hvdXRIID0gMHg0MztcbiAgICB0aGlzLmNvbW1hbmRzLmd5cm9Yb3V0TCA9IDB4NDQ7XG4gICAgdGhpcy5jb21tYW5kcy5neXJvWW91dEggPSAweDQ1O1xuICAgIHRoaXMuY29tbWFuZHMuZ3lyb1lvdXRMID0gMHg0NjtcbiAgICB0aGlzLmNvbW1hbmRzLmd5cm9ab3V0SCA9IDB4NDc7XG4gICAgdGhpcy5jb21tYW5kcy5neXJvWm91dEwgPSAweDQ4O1xuXG4gICAgdGhpcy5jb21tYW5kcy51c2VyQ3RybCA9IDB4NmE7XG4gICAgdGhpcy5jb21tYW5kcy5wd3JNZ210MSA9IDB4NmI7XG4gICAgdGhpcy5jb21tYW5kcy5wd3JNZ210MiA9IDB4NmM7XG4gICAgdGhpcy5jb21tYW5kcy5jb25maWcgPSAweDFhO1xuICAgIHRoaXMuY29tbWFuZHMuZ3lyb0NvbmZpZyA9IDB4MWI7XG4gICAgdGhpcy5jb21tYW5kcy5hY2NlbENvbmZpZyA9IDB4MWM7XG4gICAgdGhpcy5jb21tYW5kcy5hY2NlbENvbmZpZzIgPSAweDFkO1xuICAgIHRoaXMuY29tbWFuZHMuZmlmb0VuID0gMHgyMztcbiAgfVxuXG4gIHB1YmxpYyB3aXJlZChvYm5pejogYW55KSB7XG4gICAgc3VwZXIud2lyZWQob2JuaXopO1xuXG4gICAgdGhpcy5pbml0KCk7XG4gIH1cblxuICBwdWJsaWMgaTJjSW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYWRkcmVzczogMHg2OCxcbiAgICAgIGNsb2NrOiAxMDAwMDAsXG4gICAgICB2b2x0YWdlOiBcIjN2XCIsXG4gICAgfTtcbiAgfVxuXG4gIHB1YmxpYyB3aG9hbWlXYWl0KCkge1xuICAgIHJldHVybiB0aGlzLnJlYWRXYWl0KHRoaXMuY29tbWFuZHMud2hvYW1pLCAxKVswXTtcbiAgfVxuXG4gIHB1YmxpYyBpbml0KCkge1xuICAgIHRoaXMud3JpdGUodGhpcy5jb21tYW5kcy5wd3JNZ210MSwgMHgwMCk7XG4gICAgdGhpcy5vYm5pei53YWl0KDEwKTtcbiAgICB0aGlzLndyaXRlKHRoaXMuY29tbWFuZHMucHdyTWdtdDEsIDB4MDEgPDwgNyk7XG4gICAgdGhpcy5vYm5pei53YWl0KDEwKTtcbiAgICB0aGlzLndyaXRlKHRoaXMuY29tbWFuZHMucHdyTWdtdDEsIDB4MDEgPDwgMCk7XG4gICAgdGhpcy5vYm5pei53YWl0KDEwKTtcbiAgICB0aGlzLnNldENvbmZpZyhcbiAgICAgIHRoaXMucGFyYW1zLmFjY2VsZXJvbWV0ZXJfcmFuZ2UgfHwgMixcbiAgICAgIHRoaXMucGFyYW1zLmd5cm9zY29wZV9yYW5nZSB8fCAyNTAsXG4gICAgKTtcbiAgICB0aGlzLm9ibml6LndhaXQoMSk7XG4gICAgdGhpcy53cml0ZSh0aGlzLmNvbW1hbmRzLmNvbmZpZywgMHgwMSk7XG4gICAgdGhpcy5vYm5pei53YWl0KDEpO1xuICAgIHRoaXMud3JpdGUodGhpcy5jb21tYW5kcy5zbXBscnREaXYsIDB4MDUpO1xuICAgIHRoaXMub2JuaXoud2FpdCgxKTtcbiAgICB0aGlzLndyaXRlKHRoaXMuY29tbWFuZHMuaW50RW5hYmxlLCAweDAwKTtcbiAgICB0aGlzLm9ibml6LndhaXQoMSk7XG4gICAgdGhpcy53cml0ZSh0aGlzLmNvbW1hbmRzLmFjY2VsQ29uZmlnMiwgMHgwMCk7XG4gICAgdGhpcy5vYm5pei53YWl0KDEpO1xuICAgIHRoaXMud3JpdGUodGhpcy5jb21tYW5kcy51c2VyQ3RybCwgMHgwMCk7XG4gICAgdGhpcy5vYm5pei53YWl0KDEpO1xuICAgIHRoaXMud3JpdGUodGhpcy5jb21tYW5kcy5maWZvRW4sIDB4MDApO1xuICAgIHRoaXMub2JuaXoud2FpdCgxKTtcbiAgICB0aGlzLndyaXRlKHRoaXMuY29tbWFuZHMuaW50UGluQ2ZnLCAweDIyKTtcbiAgICB0aGlzLm9ibml6LndhaXQoMSk7XG4gICAgdGhpcy53cml0ZSh0aGlzLmNvbW1hbmRzLmludEVuYWJsZSwgMHgwMSk7XG4gICAgdGhpcy5vYm5pei53YWl0KDEpO1xuICB9XG5cbiAgcHVibGljIHNldENvbmZpZyhhY2NlbGVyb21ldGVyX3JhbmdlOiBhbnksIGd5cm9zY29wZV9yYW5nZTogYW55KSB7XG4gICAgLy8gYWNjZWwgcmFuZ2Ugc2V0ICgweDAwOjJnLCAweDA4OjRnLCAweDEwOjhnLCAweDE4OjE2ZylcbiAgICBzd2l0Y2ggKGFjY2VsZXJvbWV0ZXJfcmFuZ2UpIHtcbiAgICAgIGNhc2UgMjpcbiAgICAgICAgdGhpcy53cml0ZSh0aGlzLmNvbW1hbmRzLmFjY2VsQ29uZmlnLCAweDAwKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDQ6XG4gICAgICAgIHRoaXMud3JpdGUodGhpcy5jb21tYW5kcy5hY2NlbENvbmZpZywgMHgwOCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSA4OlxuICAgICAgICB0aGlzLndyaXRlKHRoaXMuY29tbWFuZHMuYWNjZWxDb25maWcsIDB4MTApO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMTY6XG4gICAgICAgIHRoaXMud3JpdGUodGhpcy5jb21tYW5kcy5hY2NlbENvbmZpZywgMHgxOCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYWNjZWxfcmFuZ2UgdmFyaWFibGUgMiw0LDgsMTYgc2V0dGluZ1wiKTtcbiAgICB9XG4gICAgLy8gZ3lybyByYW5nZSAmIExQRiBzZXQgKDB4MDA6MjUwLCAweDA4OjUwMCwgMHgxMDoxMDAwLCAweDE4OjIwMDBbZGVnL3NdKVxuICAgIHN3aXRjaCAoZ3lyb3Njb3BlX3JhbmdlKSB7XG4gICAgICBjYXNlIDI1MDpcbiAgICAgICAgdGhpcy53cml0ZSh0aGlzLmNvbW1hbmRzLmd5cm9Db25maWcsIDB4MDApO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgNTAwOlxuICAgICAgICB0aGlzLndyaXRlKHRoaXMuY29tbWFuZHMuZ3lyb0NvbmZpZywgMHgwOCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAxMDAwOlxuICAgICAgICB0aGlzLndyaXRlKHRoaXMuY29tbWFuZHMuZ3lyb0NvbmZpZywgMHgxMCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAyMDAwOlxuICAgICAgICB0aGlzLndyaXRlKHRoaXMuY29tbWFuZHMuZ3lyb0NvbmZpZywgMHgxOCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYWNjZWxfcmFuZ2UgdmFyaWFibGUgMjUwLDUwMCwxMDAwLDIwMDAgc2V0dGluZ1wiKTtcbiAgICB9XG4gICAgdGhpcy5fYWNjZWxfcmFuZ2UgPSBhY2NlbGVyb21ldGVyX3JhbmdlO1xuICAgIHRoaXMuX2d5cm9fcmFuZ2UgPSBneXJvc2NvcGVfcmFuZ2U7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgZ2V0QWxsRGF0YVdhaXQoKSB7XG4gICAgY29uc3QgcmF3X2RhdGE6IGFueSA9IGF3YWl0IHRoaXMucmVhZFdhaXQodGhpcy5jb21tYW5kcy5hY2NlbFhvdXRILCAxNCk7IC8vIHJlcXVlc3QgYWxsIGRhdGFcbiAgICBjb25zdCBhY19zY2FsZTogYW55ID0gdGhpcy5fYWNjZWxfcmFuZ2UgLyAzMjc2ODtcbiAgICBjb25zdCBneV9zY2FsZTogYW55ID0gdGhpcy5fZ3lyb19yYW5nZSAvIDMyNzY4O1xuXG4gICAgY29uc3QgYWNjZWxlcm9tZXRlcjogYW55ID0ge1xuICAgICAgeDogdGhpcy5jaGFyMnNob3J0KHJhd19kYXRhWzBdLCByYXdfZGF0YVsxXSkgKiBhY19zY2FsZSxcbiAgICAgIHk6IHRoaXMuY2hhcjJzaG9ydChyYXdfZGF0YVsyXSwgcmF3X2RhdGFbM10pICogYWNfc2NhbGUsXG4gICAgICB6OiB0aGlzLmNoYXIyc2hvcnQocmF3X2RhdGFbNF0sIHJhd19kYXRhWzVdKSAqIGFjX3NjYWxlLFxuICAgIH07XG4gICAgY29uc3QgdGVtcGVyYXR1cmU6IGFueSA9XG4gICAgICB0aGlzLmNoYXIyc2hvcnQocmF3X2RhdGFbNl0sIHJhd19kYXRhWzddKSAvIDMyNi44ICsgMjUuMDtcbiAgICBjb25zdCBneXJvc2NvcGU6IGFueSA9IHtcbiAgICAgIHg6IHRoaXMuY2hhcjJzaG9ydChyYXdfZGF0YVs4XSwgcmF3X2RhdGFbOV0pICogZ3lfc2NhbGUsXG4gICAgICB5OiB0aGlzLmNoYXIyc2hvcnQocmF3X2RhdGFbMTBdLCByYXdfZGF0YVsxMV0pICogZ3lfc2NhbGUsXG4gICAgICB6OiB0aGlzLmNoYXIyc2hvcnQocmF3X2RhdGFbMTJdLCByYXdfZGF0YVsxM10pICogZ3lfc2NhbGUsXG4gICAgfTtcblxuICAgIHJldHVybiB7XG4gICAgICBhY2NlbGVyb21ldGVyLFxuICAgICAgdGVtcGVyYXR1cmUsXG4gICAgICBneXJvc2NvcGUsXG4gICAgfTtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBnZXRUZW1wV2FpdCgpIHtcbiAgICByZXR1cm4gKGF3YWl0IHRoaXMuZ2V0QWxsRGF0YVdhaXQoKSkudGVtcGVyYXR1cmU7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgZ2V0QWNjZWxXYWl0KCkge1xuICAgIHJldHVybiAoYXdhaXQgdGhpcy5nZXRBbGxEYXRhV2FpdCgpKS5hY2NlbGVyb21ldGVyO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGdldEd5cm9XYWl0KCkge1xuICAgIHJldHVybiAoYXdhaXQgdGhpcy5nZXRBbGxEYXRhV2FpdCgpKS5neXJvc2NvcGU7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgTVBVNjg4NjtcbiJdfQ==
